mar 25, 2019 3:07:13 PM eu.bavenir.ogwapi.App initialize
CONFIG: Log file: log/19-03-25T15_07_13.738-gateway.log
mar 25, 2019 3:07:13 PM eu.bavenir.ogwapi.restapi.RestletThread <init>
CONFIG: HTTPS disabled.
mar 25, 2019 3:07:13 PM eu.bavenir.ogwapi.restapi.RestletThread <init>
CONFIG: Set to listen on port 8181
mar 25, 2019 3:07:13 PM eu.bavenir.ogwapi.App main
INFO: Vicinity Gateway API initialized.
mar 25, 2019 3:07:13 PM eu.bavenir.ogwapi.App main
FINE: API thread started.
mar 25, 2019 3:07:13 PM eu.bavenir.ogwapi.commons.CommunicationManager <init>
CONFIG: The session recovery policy is set to proactive.
mar 25, 2019 3:07:13 PM eu.bavenir.ogwapi.restapi.Api configureChallengeScheme
CONFIG: HTTP Basic challenge authentication scheme configured.
mar 25, 2019 3:07:14 PM org.restlet.Application start
INFO: Starting eu.bavenir.ogwapi.restapi.Api application
mar 25, 2019 3:07:14 PM eu.bavenir.ogwapi.restapi.Api createAuthenticator
CONFIG: Authentication realm: bavenir.eu
mar 25, 2019 3:07:14 PM org.restlet.engine.application.ApplicationHelper start
FINE: By default, an application should be attached to a parent component in order to let application's outbound root handle calls properly.
mar 25, 2019 3:07:14 PM eu.bavenir.ogwapi.restapi.RestletThread run
INFO: HTTP server configured and started.
mar 25, 2019 3:11:01 PM eu.bavenir.ogwapi.commons.CommunicationManager isConnected
INFO: Object ID: 'ecb96b72-24b1-45b2-a16b-83f0b41471e2' is not connected yet.
mar 25, 2019 3:11:01 PM eu.bavenir.ogwapi.commons.connectors.http.RestAgentConnector <init>
CONFIG: REST Agent Connector: Dummy payloads disabled, all calls to an Agent via this connector will be real.
mar 25, 2019 3:11:01 PM eu.bavenir.ogwapi.commons.connectors.http.RestAgentConnector <init>
CONFIG: REST Agent Connector: HTTPS protocol enabled for Agent communication.
mar 25, 2019 3:11:07 PM eu.bavenir.ogwapi.commons.PersistenceManager loadData
INFO: File not found!
mar 25, 2019 3:11:08 PM eu.bavenir.ogwapi.commons.PersistenceManager loadThingDescriptionFromServer
INFO: TD json for ecb96b72-24b1-45b2-a16b-83f0b41471e2 was loaded from server.
mar 25, 2019 3:11:09 PM eu.bavenir.ogwapi.commons.PersistenceManager saveThingDescription
FINE: TD json for ecb96b72-24b1-45b2-a16b-83f0b41471e2 is saved in data/ecb96b72-24b1-45b2-a16b-83f0b41471e2-TD.json
mar 25, 2019 3:11:09 PM eu.bavenir.ogwapi.commons.engines.xmpp.XmppMessageEngine buildNewConnection
CONFIG: Creating a new connection to XMPP server 'development.vicinity.ws:5222' as 'ecb96b72-24b1-45b2-a16b-83f0b41471e2@vicinity.ws'
mar 25, 2019 3:11:09 PM eu.bavenir.ogwapi.commons.engines.xmpp.XmppMessageEngine buildNewConnection
CONFIG: XMPP secure connection is disabled.
mar 25, 2019 3:11:09 PM eu.bavenir.ogwapi.commons.CommunicationManager establishConnection
INFO: Connection for 'ecb96b72-24b1-45b2-a16b-83f0b41471e2' was established.
mar 25, 2019 3:11:09 PM eu.bavenir.ogwapi.restapi.security.AuthenticationVerifier verify
INFO: Valid credentials received from a client with IP 0:0:0:0:0:0:0:1.
mar 25, 2019 3:11:09 PM org.restlet.security.ChallengeAuthenticator authenticate
FINE: Authentication succeeded. Valid credentials provided for identifier: ecb96b72-24b1-45b2-a16b-83f0b41471e2.
mar 25, 2019 3:11:09 PM org.restlet.security.Authenticator authenticated
FINE: The authentication succeeded for the identifer "ecb96b72-24b1-45b2-a16b-83f0b41471e2" using the HTTP_Basic scheme.
mar 25, 2019 3:11:09 PM org.restlet.routing.Router logRoute
FINE: Selected route: "/objects/login" -> Finder for ObjectsLogin
mar 25, 2019 3:11:09 PM org.restlet.routing.TemplateRoute beforeHandle
FINE: New base URI: "http://localhost:8181/api/objects/login". No remaining part to match
mar 25, 2019 3:11:09 PM org.restlet.engine.application.StrictConneg scoreAnnotation
FINE: Score of annotation "MethodAnnotationInfo [javaMethod: public org.restlet.representation.Representation eu.bavenir.ogwapi.restapi.services.ObjectsLogin.represent(), javaClass: class eu.bavenir.ogwapi.restapi.services.ObjectsLogin, restletMethod: GET, input: "", value: "", output: "", query: null]"= 0.5
mar 25, 2019 3:11:09 PM org.restlet.engine.application.StrictConneg scoreVariant
FINE: Total score of variant "[*/*]"= 0.041791666
mar 25, 2019 3:11:09 PM org.restlet.service.ConverterService toRepresentation
FINE: Converter selected for JsonRepresentation: DefaultConverter
mar 25, 2019 3:11:58 PM eu.bavenir.ogwapi.commons.ConnectionDescriptor processIncommingMessage
INFO: ecb96b72-24b1-45b2-a16b-83f0b41471e2: New message from test_vcnt0
mar 25, 2019 3:11:58 PM eu.bavenir.ogwapi.commons.ConnectionDescriptor processIncommingMessage
FINE: ecb96b72-24b1-45b2-a16b-83f0b41471e2: Message string: 
{"messageType":1,"requestId":1103108269,"sourceOid":"test_vcnt0","destinationOid":"ecb96b72-24b1-45b2-a16b-83f0b41471e2","requestOperation":4,"requestBody":"{\n\t\"data\": {\n\t\t\"echo\": \"start action\",\n\t\t\"oid\": \"magic-2\"\n\t},\n\t\"status\": \"success\"\n}","attributes":{"aid":"device-1-aid-1"},"parameters":{}}

mar 25, 2019 3:11:58 PM eu.bavenir.ogwapi.commons.ConnectionDescriptor processIncommingMessage
INFO: ecb96b72-24b1-45b2-a16b-83f0b41471e2: The message is a request. Processing...
mar 25, 2019 3:11:58 PM eu.bavenir.ogwapi.commons.ConnectionDescriptor processMessageRequest
INFO: ecb96b72-24b1-45b2-a16b-83f0b41471e2: Request ID is 1103108269, operation is STARTACTION.
mar 25, 2019 3:12:29 PM eu.bavenir.ogwapi.commons.Action <init>
CONFIG: Action device-1-aid-1 time to keep return values set to (ms): 86400000
mar 25, 2019 3:12:29 PM eu.bavenir.ogwapi.commons.Action <init>
CONFIG: Action device-1-aid-1 pending tasks timeout set to (ms): 7200000
mar 25, 2019 3:12:29 PM eu.bavenir.ogwapi.commons.Action <init>
CONFIG: Action device-1-aid-1 max number of pending tasks set to: 128
mar 25, 2019 3:12:29 PM eu.bavenir.ogwapi.commons.ConnectionDescriptor respondToStartActionRequest
INFO: ecb96b72-24b1-45b2-a16b-83f0b41471e2: Created task d36a8509-6e3c-43b9-be04-2299b085af84 of action device-1-aid-1 and added it to the queue.
mar 25, 2019 3:12:29 PM eu.bavenir.ogwapi.commons.ConnectionDescriptor sendMessage
INFO: ecb96b72-24b1-45b2-a16b-83f0b41471e2: Sending message: 
{"messageType":2,"requestId":1103108269,"sourceOid":"ecb96b72-24b1-45b2-a16b-83f0b41471e2","destinationOid":"test_vcnt0","error":false,"responseCode":201,"responseCodeReason":"Created. New task added to the queue.","contentType":"application/json","responseBody":"{\"taskId\":\"d36a8509-6e3c-43b9-be04-2299b085af84\"}","responseBodySupplement":null}
mar 25, 2019 3:12:29 PM eu.bavenir.ogwapi.commons.CommunicationManager tryToSendLocalMessage
FINE: Can't send the message locally, the destination OID is not from this infrastructure.
mar 25, 2019 3:12:29 PM eu.bavenir.ogwapi.commons.ConnectionDescriptor sendMessage
FINE: ecb96b72-24b1-45b2-a16b-83f0b41471e2: Message was sent through network.
mar 25, 2019 3:12:30 PM eu.bavenir.ogwapi.commons.Action workThroughTasks
FINE: AID device-1-aid-1: There is no task running, yet there are tasks pending. Taking the next task.
mar 25, 2019 3:12:30 PM eu.bavenir.ogwapi.commons.connectors.http.RestAgentConnector performOperation
FINE: REST Agent Connector:
Operation code: 1
Assembled full URL: https://localhost:9997/agent/objects/ecb96b72-24b1-45b2-a16b-83f0b41471e2/actions/device-1-aid-1
Parameters: {sourceOid=test_vcnt0}
Body: {
	"data": {
		"echo": "start action",
		"oid": "magic-2"
	},
	"status": "success"
}
mar 25, 2019 3:12:30 PM eu.bavenir.ogwapi.commons.connectors.http.RestAgentConnector performOperation
WARNING: Exception when connecting to Agent: org.apache.http.conn.HttpHostConnectException: Connect to localhost:9997 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused (Connection refused)
The whole exception: com.mashape.unirest.http.exceptions.UnirestException: org.apache.http.conn.HttpHostConnectException: Connect to localhost:9997 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused (Connection refused)
	at com.mashape.unirest.http.HttpClientHelper.request(HttpClientHelper.java:143)
	at com.mashape.unirest.request.BaseRequest.asString(BaseRequest.java:56)
	at eu.bavenir.ogwapi.commons.connectors.http.RestAgentConnector.performOperation(RestAgentConnector.java:561)
	at eu.bavenir.ogwapi.commons.connectors.http.RestAgentConnector.startObjectAction(RestAgentConnector.java:382)
	at eu.bavenir.ogwapi.commons.Task.start(Task.java:232)
	at eu.bavenir.ogwapi.commons.Action.workThroughTasks(Action.java:665)
	at eu.bavenir.ogwapi.commons.Action.access$000(Action.java:77)
	at eu.bavenir.ogwapi.commons.Action$1.run(Action.java:305)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:556)
	at java.base/java.util.TimerThread.run(Timer.java:506)
Caused by: org.apache.http.conn.HttpHostConnectException: Connect to localhost:9997 [localhost/127.0.0.1, localhost/0:0:0:0:0:0:0:1] failed: Connection refused (Connection refused)
	at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:159)
	at org.apache.http.impl.conn.PoolingHttpClientConnectionManager.connect(PoolingHttpClientConnectionManager.java:373)
	at org.apache.http.impl.execchain.MainClientExec.establishRoute(MainClientExec.java:394)
	at org.apache.http.impl.execchain.MainClientExec.execute(MainClientExec.java:237)
	at org.apache.http.impl.execchain.ProtocolExec.execute(ProtocolExec.java:185)
	at org.apache.http.impl.execchain.RetryExec.execute(RetryExec.java:89)
	at org.apache.http.impl.execchain.RedirectExec.execute(RedirectExec.java:110)
	at org.apache.http.impl.client.InternalHttpClient.doExecute(InternalHttpClient.java:185)
	at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:83)
	at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:108)
	at org.apache.http.impl.client.CloseableHttpClient.execute(CloseableHttpClient.java:56)
	at com.mashape.unirest.http.HttpClientHelper.request(HttpClientHelper.java:138)
	... 9 more
Caused by: java.net.ConnectException: Connection refused (Connection refused)
	at java.base/java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.base/java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:399)
	at java.base/java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:242)
	at java.base/java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:224)
	at java.base/java.net.SocksSocketImpl.connect(SocksSocketImpl.java:403)
	at java.base/java.net.Socket.connect(Socket.java:591)
	at org.apache.http.conn.ssl.SSLConnectionSocketFactory.connectSocket(SSLConnectionSocketFactory.java:339)
	at org.apache.http.impl.conn.DefaultHttpClientConnectionOperator.connect(DefaultHttpClientConnectionOperator.java:142)
	... 20 more

mar 25, 2019 3:12:30 PM eu.bavenir.ogwapi.commons.Task start
WARNING: Task d36a8509-6e3c-43b9-be04-2299b085af84 could not be executed - AgentConnector returned error or null repsponse.
mar 25, 2019 3:12:30 PM eu.bavenir.ogwapi.commons.Action workThroughTasks
WARNING: AID device-1-aid-1: Task d36a8509-6e3c-43b9-be04-2299b085af84 failed to start.
mar 25, 2019 3:13:39 PM eu.bavenir.ogwapi.restapi.security.AuthenticationVerifier verify
INFO: Valid credentials received from a client with IP 0:0:0:0:0:0:0:1.
mar 25, 2019 3:13:39 PM org.restlet.security.ChallengeAuthenticator authenticate
FINE: Authentication succeeded. Valid credentials provided for identifier: ecb96b72-24b1-45b2-a16b-83f0b41471e2.
mar 25, 2019 3:13:39 PM org.restlet.security.Authenticator authenticated
FINE: The authentication succeeded for the identifer "ecb96b72-24b1-45b2-a16b-83f0b41471e2" using the HTTP_Basic scheme.
mar 25, 2019 3:13:39 PM org.restlet.routing.Router logRoute
FINE: Selected route: "/events/{eid}" -> Finder for EventsEid
mar 25, 2019 3:13:39 PM org.restlet.routing.TemplateRoute beforeHandle
FINE: New base URI: "http://localhost:8181/api/events/event-1". No remaining part to match
mar 25, 2019 3:13:39 PM org.restlet.engine.application.StrictConneg scoreAnnotation
FINE: Score of annotation "MethodAnnotationInfo [javaMethod: public org.restlet.representation.Representation eu.bavenir.ogwapi.restapi.services.EventsEid.accept(org.restlet.representation.Representation), javaClass: class eu.bavenir.ogwapi.restapi.services.EventsEid, restletMethod: POST, input: "json", value: "json", output: "json", query: null]"= 0.5
mar 25, 2019 3:13:39 PM org.restlet.engine.application.StrictConneg scoreVariant
FINE: Total score of variant "[*/*]"= 0.041791666
mar 25, 2019 3:14:03 PM eu.bavenir.ogwapi.commons.PersistenceManager saveData
FINE: Serialized data for ecb96b72-24b1-45b2-a16b-83f0b41471e2 is saved in data/ecb96b72-24b1-45b2-a16b-83f0b41471e2-data.ser
mar 25, 2019 3:14:08 PM eu.bavenir.ogwapi.commons.ConnectionDescriptor setLocalEventChannelStatus
INFO: ecb96b72-24b1-45b2-a16b-83f0b41471e2: Created active event channel event-1.
mar 25, 2019 3:14:08 PM org.restlet.service.ConverterService toRepresentation
FINE: Converter selected for JsonRepresentation: DefaultConverter
